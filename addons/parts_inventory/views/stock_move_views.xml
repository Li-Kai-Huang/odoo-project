<!-- addons/parts_inventory/views/stock_move_views.xml -->
<odoo>
  <record id="view_stock_move_tree" model="ir.ui.view">
    <field name="name">parts.inventory.stock.move.tree</field>
    <field name="model">parts.inventory.stock.move</field>
    <field name="arch" type="xml">
      <tree editable="bottom">
        <field name="date"/>
        <field name="move_type"/>
        <field name="quantity"/>
        <field name="state" readonly="1"/>
        <field name="note"/>
      </tree>
    </field>
  </record>

  <record id="view_stock_move_form" model="ir.ui.view">
    <field name="name">parts.inventory.stock.move.form</field>
    <field name="model">parts.inventory.stock.move</field>
    <field name="arch" type="xml">
      <form>
        <header>
          <button name="action_confirm" type="object"
                  string="Confirm" class="oe_highlight"
                  invisible="state != 'draft'"/>
          <button name="action_cancel" type="object"
                  string="Cancel" class="btn-secondary"
                  invisible="state != 'confirmed'"/>
        </header>
        <sheet>
          <group>
            <field name="part_id" options="{'no_create_edit': True}"/>
            <field name="move_type"/>
            <field name="quantity"/>
            <field name="date"/>
            <field name="state" readonly="1"/>
            <field name="note"/>
          </group>
        </sheet>
      </form>
    </field>
  </record>

  <!-- ✅ 從 Part 啟動的 Moves action（只看該 Part） -->
  <record id="action_moves_from_part" model="ir.actions.act_window">
    <field name="name">Team Moves</field>
    <field name="res_model">parts.inventory.stock.move</field>
    <field name="view_mode">tree,form</field>
    <field name="domain">[('part_id', '=', active_id)]</field>
    <field name="context">{}</field>
    <field name="target">current</field>
  </record>

  <!-- 定義被產品頁 Smart Button 呼叫的 action -->
<record id="action_team_moves" model="ir.actions.act_window">
  <field name="name">Team Moves</field>
  <field name="res_model">parts.inventory.stock.move</field>
  <field name="view_mode">tree,form</field>
  <!-- 這裡先不要用 product_tmpl_id 篩，因為你的 move 目前只有 part_id
       先給空的 domain，之後再補資料模型對應 -->
  <field name="domain">[]</field>
  <field name="context">{}</field>
  <field name="target">current</field>
</record>

</odoo>
